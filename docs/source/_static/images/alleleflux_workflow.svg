<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="700" height="450" xmlns="http://www.w3.org/2000/svg">
  <!-- Main flow boxes -->
  <!-- Row 1 -->
  <rect x="50" y="50" width="160" height="80" rx="5" ry="5" fill="#e1f5fe" stroke="#01579b" stroke-width="2"/>
  <rect x="270" y="50" width="160" height="80" rx="5" ry="5" fill="#e1f5fe" stroke="#01579b" stroke-width="2"/>
  <rect x="490" y="50" width="160" height="80" rx="5" ry="5" fill="#e1f5fe" stroke="#01579b" stroke-width="2"/>
  
  <!-- Row 2 -->
  <rect x="270" y="185" width="160" height="80" rx="5" ry="5" fill="#fff3e0" stroke="#e65100" stroke-width="2"/>
  
  <!-- Row 3 -->
  <rect x="50" y="320" width="160" height="80" rx="5" ry="5" fill="#e0f2f1" stroke="#004d40" stroke-width="2"/>
  <rect x="270" y="320" width="160" height="80" rx="5" ry="5" fill="#e0f2f1" stroke="#004d40" stroke-width="2"/>
  <rect x="490" y="320" width="160" height="80" rx="5" ry="5" fill="#e0f2f1" stroke="#004d40" stroke-width="2"/>
  
  <!-- Arrows -->
  <!-- Row 1 connections -->
  <path d="M 210 90 L 270 90" stroke="#424242" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <path d="M 430 90 L 490 90" stroke="#424242" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- Row 2 -->
  <rect x="300" y="200" width="200" height="100" rx="10" ry="10" fill="#ffead6" stroke="#ff6600" stroke-width="2"/>
  
  <!-- Row 3 -->
  <rect x="50" y="350" width="200" height="100" rx="10" ry="10" fill="#d6ffea" stroke="#009933" stroke-width="2"/>
  <rect x="300" y="350" width="200" height="100" rx="10" ry="10" fill="#d6ffea" stroke="#009933" stroke-width="2"/>
  <rect x="550" y="350" width="200" height="100" rx="10" ry="10" fill="#d6ffea" stroke="#009933" stroke-width="2"/>
  
  <!-- Arrows -->
  <!-- Row 1 to Row 2 -->
  <path d="M 570 130 L 570 155 L 350 155 L 350 185" stroke="#424242" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- Row 2 to Row 3 -->
  <path d="M 350 265 L 350 290 L 570 290 L 570 320" stroke="#424242" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- Row 3 connections -->
  <path d="M 490 360 L 430 360" stroke="#424242" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <path d="M 270 360 L 210 360" stroke="#424242" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- Bi-directional between Score Generation and Outlier Detection -->
  <path d="M 330 265 L 330 320" stroke="#424242" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <path d="M 370 320 L 370 265" stroke="#424242" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- Arrowhead marker -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="7" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#424242"/>
    </marker>
  </defs>
  
  
  <!-- Text labels -->
  <!-- Row 1 -->
  <text x="130" y="75" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">Input Data</text>
  <text x="130" y="95" font-family="Arial" font-size="10" text-anchor="middle">MAG sequences</text>
  <text x="130" y="110" font-family="Arial" font-size="10" text-anchor="middle">Sample metadata</text>
  <text x="130" y="125" font-family="Arial" font-size="10" text-anchor="middle">BAM files</text>
  
  <text x="350" y="75" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">Preprocessing</text>
  <text x="350" y="95" font-family="Arial" font-size="10" text-anchor="middle">Quality control</text>
  <text x="350" y="110" font-family="Arial" font-size="10" text-anchor="middle">Eligibility tables</text>
  <text x="350" y="125" font-family="Arial" font-size="10" text-anchor="middle">Metadata prep</text>
  
  <text x="570" y="75" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">Allele Analysis</text>
  <text x="570" y="95" font-family="Arial" font-size="10" text-anchor="middle">Compute frequencies</text>
  <text x="570" y="110" font-family="Arial" font-size="10" text-anchor="middle">Analyze changes</text>
  <text x="570" y="125" font-family="Arial" font-size="10" text-anchor="middle">Filter (optional)</text>
  
  <!-- Row 2 -->
  <text x="350" y="210" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">Score Generation</text>
  <text x="350" y="230" font-family="Arial" font-size="10" text-anchor="middle">Parallelism scores</text>
  <text x="350" y="245" font-family="Arial" font-size="10" text-anchor="middle">Divergence scores</text>
  <text x="350" y="260" font-family="Arial" font-size="10" text-anchor="middle">Taxonomic aggregation</text>
  
  <!-- Row 3 -->
  <text x="130" y="345" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">Results Analysis</text>
  <text x="130" y="365" font-family="Arial" font-size="10" text-anchor="middle">Summary statistics</text>
  <text x="130" y="380" font-family="Arial" font-size="10" text-anchor="middle">Visualizations</text>
  <text x="130" y="395" font-family="Arial" font-size="10" text-anchor="middle">Functional analysis</text>
  
  <text x="350" y="345" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">Outlier Detection</text>
  <text x="350" y="365" font-family="Arial" font-size="10" text-anchor="middle">High score genes</text>
  <text x="350" y="380" font-family="Arial" font-size="10" text-anchor="middle">Statistical assessment</text>
  
  <text x="570" y="345" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">Statistical Testing</text>
  <text x="570" y="365" font-family="Arial" font-size="10" text-anchor="middle">Two-sample tests</text>
  <text x="570" y="380" font-family="Arial" font-size="10" text-anchor="middle">Single-sample</text>
  <text x="570" y="395" font-family="Arial" font-size="10" text-anchor="middle">LMM / CMH tests</text>
</svg>
  
  <!-- Text labels -->
  <!-- Row 1 -->
  <text x="150" y="80" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">Input Data</text>
  <text x="150" y="100" font-family="Arial" font-size="12" text-anchor="middle">MAG sequences</text>
  <text x="150" y="120" font-family="Arial" font-size="12" text-anchor="middle">Sample metadata</text>
  <text x="150" y="140" font-family="Arial" font-size="12" text-anchor="middle">BAM files</text>
  
  <text x="400" y="80" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">Preprocessing</text>
  <text x="400" y="100" font-family="Arial" font-size="12" text-anchor="middle">Quality control</text>
  <text x="400" y="120" font-family="Arial" font-size="12" text-anchor="middle">Eligibility tables</text>
  <text x="400" y="140" font-family="Arial" font-size="12" text-anchor="middle">Metadata preparation</text>
  
  <text x="650" y="80" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">Allele Analysis</text>
  <text x="650" y="100" font-family="Arial" font-size="12" text-anchor="middle">Compute frequencies</text>
  <text x="650" y="120" font-family="Arial" font-size="12" text-anchor="middle">Analyze changes</text>
  <text x="650" y="140" font-family="Arial" font-size="12" text-anchor="middle">Filter (optional)</text>
  
  <!-- Row 2 -->
  <text x="400" y="230" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">Score Generation</text>
  <text x="400" y="250" font-family="Arial" font-size="12" text-anchor="middle">Parallelism scores</text>
  <text x="400" y="270" font-family="Arial" font-size="12" text-anchor="middle">Divergence scores</text>
  <text x="400" y="290" font-family="Arial" font-size="12" text-anchor="middle">Taxonomic aggregation</text>
  
  <!-- Row 3 -->
  <text x="150" y="380" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">Results Interpretation</text>
  <text x="150" y="400" font-family="Arial" font-size="12" text-anchor="middle">Summary statistics</text>
  <text x="150" y="420" font-family="Arial" font-size="12" text-anchor="middle">Visualizations</text>
  <text x="150" y="440" font-family="Arial" font-size="12" text-anchor="middle">Functional analysis</text>
  
  <text x="400" y="380" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">Outlier Detection</text>
  <text x="400" y="400" font-family="Arial" font-size="12" text-anchor="middle">High score genes</text>
  <text x="400" y="420" font-family="Arial" font-size="12" text-anchor="middle">Statistical assessment</text>
  
  <text x="650" y="380" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">Statistical Testing</text>
  <text x="650" y="400" font-family="Arial" font-size="12" text-anchor="middle">Two-sample tests</text>
  <text x="650" y="420" font-family="Arial" font-size="12" text-anchor="middle">Single-sample</text>
  <text x="650" y="440" font-family="Arial" font-size="12" text-anchor="middle">LMM / CMH tests</text>
</svg>
